---
layout: article
title: The Big Hack - Disconnecting the Dots
categories: "articles"
image:
  teaser: finger.png
  thumb: finger.png
author: joefitz
published: false
---





>> In simplified form, FitzPatrick says, an implant alters the
core instructions telling the server what to do as data moves
across a motherboard. This microengineering feat happens at
the crucial moment when small bits of the operating system
are being fed from temporary memory to the central processing
unit. An implant is placed on the board in a position that
allows it to effectively jump the information queue, injecting
its own code and adding malicious instructions that the CPU
will follow. Deviously small alterations to the operating system
can produce disastrous effects, and no commercial security
system can tell that anything is amiss. “In practice, once they’re
running privileged code, it’s game over,” FitzPatrick says. 














We've now got not one, but two separate articles about hardware implants. I and others have been reviewing, discussing, and criticising them for the past several days. The biggest question is why the article seems so wrong.

I've got a theory, but it builds on lots of the details in the article, so it makes sense for me to give you my impression. I won't go over line-by-line but will cover the highlights.

> To help with due diligence, AWS, which was overseeing the prospective acquisition, hired a third-party company to scrutinize Elemental’s security, according to one person familiar with the process. The first pass uncovered troubling issues...
Nothing surprising here. This is how it works. There's no detail of what issues were found

> Nested on the servers’ motherboards, the testers found a tiny microchip, not much bigger than a grain of rice, that wasn’t part of the boards’ original design.
This seems like a surprise. But as I have explained previously, board changes, revisions and inaccurate schematics happen. We get no details of what the microchips were, what they did, or even that they were malicious. A source providing this information could be 100% accurate without this being a newsworthy event.

> Amazon reported the discovery to U.S. authorities, sending a shudder through the intelligence community...  investigators determined that the chips allowed the attackers to create a stealth doorway into any network that included the altered machines... 
This seems to refer to different investigators, which perhaps means a different source. That also means there could easily be a disconnenct. For example:
- are we sure these investigators are investigating the same tiny microchip?
- are we sure these investigators are investigating a microchip, and not malicious firmware?
- are we sure the source is a technical person who saw the device AND understands hardware?


> Multiple people familiar with the matter say investigators found that the chips had been inserted at factories run by manufacturing subcontractors in China.
That's where chips are installed. I will say that on the record about most chips.

> Still, to actually accomplish a seeding attack would mean developing a deep understanding of a product’s design, manipulating components at the factory, and ensuring that the doctored devices made it through the global logistics chain to the desired location—a feat akin to throwing a stick in the Yangtze River upstream from Shanghai and ensuring that it washes ashore in Seattle. 
Regarding Supermicro, the article previously claimed 'The company’s pitch to customers hinges on unmatched customization...'. That's true but might not mean what you think it means.
- if you're buying 10,000 servers, you get to dictate lots of details
- if you're buying 10,000 custom servers, they're all going to be assembled at once
- if you're _only_ buying 10,000 _custom_ servers, the mainboard probably isn't really custom. You just get to pick how many slots, ports, connectors, and other features are *populated* on your *customizable* mainboard.
This means a few things:
- to infiltrate company X's servers, you just need to know where and when they'll be assembled
- to infiltrate many companny's servers, you can likely reuse one hack on all of the same model board - or even, all boards that use a ubiquitous part, like the ASPEED BMC that Supermicro uses.
So, from a technical perspective, the article makes this out to be harder than it probably is
Despite all that:

> “Having a well-done, nation-state-level hardware implant surface would be like witnessing a unicorn jumping over a rainbow,” says Joe Grand, a hardware hacker and the founder of Grand Idea Studio Inc. “Hardware is just so far off the radar, it’s almost treated like black magic.”
Joe's right - abut a hardware attack. We've got more options

> But that’s just what U.S. investigators found: The chips had been inserted during the manufacturing process, two officials say, by operatives from a unit of the People’s Liberation Army.
We're back to those same investigators. Perhaps this information came from the same *two* sources.

> One official says investigators found that it eventually affected almost 30 companies, including a major bank, government contractors, and the world’s most valuable company, Apple Inc. Apple was an important Supermicro customer and had planned to order more than 30,000 of its servers in two years for a new global network of data centers. 
We're back to one official. Maybe only one of the two previous, or maybe a third official. If a third official, we could be hopping to a diferent story. And sure enough..

> Three senior insiders at Apple say that in the summer of 2015, it, too, found malicious chips on Supermicro motherboards. Apple severed ties with Supermicro the following year, for what it described as unrelated reasons.
Three different sources now - apple insiders, not (government?) 'officials'. Between you and me, I'd ditch hardware with malicious implants immediately, but apple kept them for a year? However, the timeline fits close enough with reports of apple finding malware-infected firmware in 2016 and facebook hearing about it in 2015. But neither of those are about malicious *CHIPS*. 



In emailed statements, Amazon (which announced its acquisition of Elemental in September 2015), Apple, and Supermicro disputed summaries of Bloomberg Businessweek’s reporting. “It’s untrue that AWS knew about a supply chain compromise, an issue with malicious chips, or hardware modifications when acquiring Elemental,” Amazon wrote. “On this we can be very clear: Apple has never found malicious chips, ‘hardware manipulations’ or vulnerabilities purposely planted in any server,” Apple wrote. “We remain unaware of any such investigation,” wrote a spokesman for Supermicro, Perry Hayes. 

In all, 17 people confirmed the manipulation of Supermicro’s hardware and other elements of the attacks. The sources were granted anonymity because of the sensitive, and in some cases classified, nature of the information.

(A U.S. official says the government’s probe is still examining whether spies were planted inside Supermicro or other American companies to aid the attack.)

But in the first half of 2014, a different person briefed on high-level discussions says, intelligence officials went to the White House with something more concrete: China’s military was preparing to insert the chips into Supermicro motherboards bound for U.S. companies.


Apple made its discovery of suspicious chips inside Supermicro servers around May 2015, after detecting odd network activity and firmware problems, according to a person familiar with the timeline. 


The chips on Elemental servers were designed to be as inconspicuous as possible, according to one person who saw a detailed report prepared for Amazon by its third-party security contractor, as well as a second person who saw digital photos and X-ray images of the chips incorporated into a later report prepared by Amazon’s security team. Gray or off-white in color, they looked more like signal conditioning couplers, another common motherboard component, than microchips, and so they were unlikely to be detectable without specialized equipment. Depending on the board model, the chips varied slightly in size, suggesting that the attackers had supplied different factories with different batches.

"Hardware attacks are about access"


